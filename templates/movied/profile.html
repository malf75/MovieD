{% extends 'movied/base.html' %}
{% load static %}
{% block content %}

{% if profile %}
<section class="redirect">
<div>
    <button id="btn" title="botão darkmode"><i class="fa-solid fa-moon"></i></button>
</div>
</section>
<div class="vl"></div>
<section>
    <div class="container3">
        <a href="{% url 'index' %}" class="logo__ancora"><img class="logo logo__profile" src="https://movied-bucket.s3.amazonaws.com/static/media/Design_sem_nome-removebg-preview.png" alt="logo do movied"></a>
        <div>
            {% if profile == user.profile %}
                <input type="checkbox" id="menu2" class="container__btn">
                <label for="menu2">
                {% if profile.user.profile.profile_image %}              
                    <img src="{{ profile.user.profile.profile_image.url }}" class="foto__perfil-pp" alt="foto de perfil">   
                {% else %}
                    <img src="https://movied-bucket.s3.amazonaws.com/static/media/default.jpg" class="foto__perfil-pp" alt="foto de perfil">
                {% endif %}
                </label>
                <ul class="lista-menu2">
                    <li class="lista-menu__item2">
                        <a href="{% url 'profileedit' profile.user.id %}" class="lista-menu__link2">Edit Profile</a>
                    </li>
                </ul>
            {% else %}
            {% if profile.user.profile.profile_image %}
                <img src="{{ profile.user.profile.profile_image.url }}" class="foto__perfil-pp" alt="foto de perfil">
            {% else %}
                <img src="https://movied-bucket.s3.amazonaws.com/static/media/default.jpg" class="foto__perfil-pp" alt="foto de perfil">
            {% endif %}
            {% endif %}
        </div>
        <h1 class="nome__perfil">{{ profile.user.username }}</h1>
        {% if profile.bio %}
            <p class="bio">{{ profile.user.profile.bio }}</p>
        {% endif %}
        <div class="follows__f">
            <strong class="follows">Followed By</strong>
            <a href="{% url 'followers' profile.user.id %}" class="fol">{{ profile.followed_by.all|length }}</a>
            <strong class="following">Following</strong>
            <a href="{% url 'following' profile.user.id %}" class="fol">{{ profile.follows.all|length }}</a>
            {% if profile == user.profile %}
            {% else %}
            <form method="POST">
                {% csrf_token %}
                {% if profile in user.profile.follows.all %}
                    <button class="botao_follow" name="follow" value="unfollow" type="submit">Unfollow</button>
                {% else %}
                    <button class="botao_follow" name="follow" value="follow" type="submit">Follow</button>
                {% endif %}
            </form>
            {% endif %}
        </div>
        {% if posts %}
                {% for postagem in posts %}
                <div class="quem">
                {% if postagem.user.profile.profile_image %}
                <div id="container2">
                    <img class="foto__perfil" src="{{ postagem.user.profile.profile_image.url }}" class="foto__perfil-post">
                </div>
                {% else %}
                <div id="container2">
                    <img src="https://movied-bucket.s3.amazonaws.com/static/media/default.jpg" class="foto__perfil" alt="foto de perfil">
                </div>
                {% endif %}
                <p class="postagem__data"><strong>{{ postagem.user }}</strong> • {{ postagem.data_postagem }}</p>
                {% if postagem.user == request.user %}
                <a href="{% url 'deletar_postagem' postagem.id %}" class="remove__post"><i class="fa-solid fa-trash"></i></a>
                {% else %}
                <a href="{% url 'reportar_postagem' postagem.id %}" class="report__post"><i class="fa-solid fa-triangle-exclamation"></i></a>
                {% endif %}
                </div>
            <div class="paragrafo">
                <p class="postagem__paragrafo">{{ postagem.comentario }}</p>
            </div>
            {% for filme in postagem.filmes.all %}
            <div class="filme__container">
                {% if filme.Streaming %}
                <a href="{{filme.Streaming}}" target="_blank" rel="noopener noreferrer"><img class="imagem__filme" src="{{filme.Poster_Link}}" alt="Poster do Filme"></a>
                {% else %}
                <a><img class="imagem__filme" src="{{filme.Poster_Link}}" alt="Poster do Filme"></a>
                {% endif %}
              <li class="filme__item">
                <p class="filme__item-p">Name: {{filme.Series_Title}}</p>
                <p class="filme__item-p">Overview: {{filme.Overview}}</p>
                <p class="filme__item-p">Runtime: {{filme.Runtime}}</p>
                <p class="filme__item-p">IMDB Rating: {{filme.Rating}}</p>
                <p class="filme__item-p">Released: {{filme.Released_Year}}</p>
                <p class="filme__item-p">Genre: {{filme.Genre}}</p>
              </li>
            </div>
            {% endfor %}
            <div class="filme__opcoes">
                {% if user in postagem.likes.all %}
                <p class="number__likes">{{postagem.number_of_likes}}</p><a href="{% url 'postagem_like' postagem.id %}" class="filme__like"><i class="fa-solid fa-heart"></i></a>
                {% else %}
                <p class="number__likes">{{postagem.number_of_likes}}</p><a href="{% url 'postagem_like' postagem.id %}" class="filme__like"><i class="fa-regular fa-heart"></i></a>
                {% endif %}
                <p class="comentarios__length">{{ postagem.comentarios_postagem.all.count }}</p><a href="{% url 'comentarios' postagem.id %}" class="filme__comment"><i class="fa-regular fa-comment"></i></a>
                <a href="#" class="filme__save"><i class="fa-regular fa-bookmark"></i></a>
            </div>
        </div>
        {% endfor %}
        {% else %}
        {% endif %}
</div>
{% endif %}
</section>
<div class="vl2"></div>
<section>
    
</section>

{% endblock %}