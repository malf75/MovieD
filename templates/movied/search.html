{% extends 'movied/base.html' %}
{% load static %}
{% block content %}
{% load custom_filters %}
<section>
    <div>
        <button id="btn"><i class="fa-solid fa-moon"></i></button>
    </div>
</section>
<hl class="vl"></hl>
<section class="mid__section">
    <a href="{% url 'index' %}" class="logo__ancora" id="logo__ancora"><img class="logo" src="https://movied-bucket.s3.amazonaws.com/static/media/Design_sem_nome-removebg-preview.png" alt="logo do movied"></a>
    <div class="container4">
    <div class="buttons">
        <button class="search__all">All</button>
        <button class="search__reviews">Reviews</button>
        <button class="search__users">Users</button>
    </div>
    {% for postagem in posts %}
                <div class="quem">
                {% if postagem.user.profile.profile_image %}
                <div id="container2">
                    <a href="{% url 'profile' postagem.user.id %}"><img class="foto__perfil" src="{{ postagem.user.profile.profile_image.url }}" class="foto__perfil-post" alt="foto de perfil"></a>
                </div>
                {% else %}
                <div id="container2">
                    <a href="{% url 'profile' postagem.user.id %}"><img src="https://movied-bucket.s3.amazonaws.com/static/media/default.jpg" class="foto__perfil" alt="foto de perfil"></a>
                </div>
                {% endif %}
                {% if postagem.user.profile.isVerified %}
                <p class="postagem__data"><strong>{{ postagem.user }} </strong><i class="fa-solid fa-circle-check"></i> • {{ postagem.data_postagem }}</p>
                {% else %}
                <p class="postagem__data"><strong>{{ postagem.user }} </strong> • {{ postagem.data_postagem }}</p>
                {% endif %}
                {% if postagem.user == request.user %}
                <a href="{% url 'deletar_postagem' postagem.id %}" class="remove__post"><i class="fa-solid fa-trash"></i></a>
                {% else %}
                <a href="{% url 'reportar_postagem' postagem.id %}" class="report__post"><i class="fa-solid fa-triangle-exclamation"></i></a>
                {% endif %}
                </div>
            <div class="paragrafo">
                <p class="postagem__paragrafo">{{ postagem.comentario|linebreaksbr }}</p>
            </div>
            {% for filme in postagem.filmes.all %}
            <div class="filme__container">
                {% if filme.Streaming %}
                <a href="{{filme.Streaming}}" target="_blank" rel="noopener noreferrer"><img class="imagem__filme" src="{{filme.Poster_Link}}" alt="Poster do Filme"></a>
                {% else %}
                <a><img class="imagem__filme" src="{{filme.Poster_Link}}" alt="Poster do Filme"></a>
                {% endif %}
              <li class="filme__item">
                <p class="filme__item-p">Name: {{filme.Series_Title}}</p>
                <p class="filme__item-p">Overview: {{filme.Overview | truncate_chars:180}}...</p>
                <p class="filme__item-p">Runtime: {{filme.Runtime}}</p>
                <p class="filme__item-p">IMDB Rating: {{filme.Rating}}</p>
                <p class="filme__item-p">Released: {{filme.Released_Year}}</p>
                <p class="filme__item-p">Genre: {{filme.Genre}}</p>
              </li>
            </div>
            {% endfor %}
            <div class="filme__opcoes">
                {% if user in postagem.likes.all %}
                <p data-post-id="{{ postagem.id }}" class="number__likes">{{postagem.number_of_likes}}</p><a href="{% url 'postagem_like' postagem.id %}" class="filme__like" data-post-id="{{ postagem.id }}" data-csrf-token="{{ csrf_token }}"><i class="fa-solid fa-heart"></i></a>
                {% else %}
                <p data-post-id="{{ postagem.id }}" class="number__likes">{{postagem.number_of_likes}}</p><a href="{% url 'postagem_like' postagem.id %}" class="filme__like" data-post-id="{{ postagem.id }}" data-csrf-token="{{ csrf_token }}"><i class="fa-regular fa-heart"></i></a>
                {% endif %}
                <p class="comentarios__length">{{ postagem.comentarios_postagem.all.count }}</p><a href="{% url 'comentarios' postagem.id %}" class="filme__comment"><i class="fa-regular fa-comment"></i></a>
                {% if user in postagem.list.all %}
                <p data-post-id="{{ postagem.id }}" class="number__save">{{ postagem.list.all.count }}</p><a href="#" data-post-id="{{ postagem.id }}" data-csrf-token="{{ csrf_token }}" class="filme__save"><i class="fa-solid fa-bookmark"></i></a>
                {% else %}
                <p data-post-id="{{ postagem.id }}" class="number__save">{{ postagem.list.all.count }}</p><a data-post-id="{{ postagem.id }}" data-csrf-token="{{ csrf_token }}" href="{% url 'save_movie' postagem.id %}" class="filme__save"><i class="fa-regular fa-bookmark"></i></a>
                {% endif %}
            </div>
        {% endfor %}
        {% for profile in users %}
            <div class="followers__card">
                {% if profile.profile.profile_image %}
                <a href="{% url 'profile' profile.id %}"><img src="{{ profile.profile.profile_image.url }}" class="foto__followers" alt="{{ profile.user.username }}"></a>
                {% else %}
                <a href="{% url 'profile' profile.id %}"><img src="https://movied-bucket.s3.amazonaws.com/static/media/default.jpg" class="foto__followers" alt="{{ profile.user.username }}"></a>
                {% endif %}
                <div class="nome__bio">
                    {% if profile.profile.isVerified %}
                    <h3 class="username__followers">{{ profile.username }} <i class="fa-solid fa-circle-check"></i></h3>
                    {% else %}
                    <h3 class="username__followers">{{ profile.username }}</h3>
                    {% endif %}
                    {% if profile.profile.bio %}
                    <p class="bio__followers">{{ profile.profile.bio }}</p>
                    {% endif %}
                </div>
            </div>
        {% endfor %}
    </div>
</section>
<hl class="vl2"></hl>
<section>
</section>
<script src="{% static 'app/search.js' %}"></script>
{% endblock %}